diff --git a/src/java/org/apache/commons/codec/binary/Base64.java b/src/java/org/apache/commons/codec/binary/Base64.java
index b5895635..20c6b31d 100644
--- a/src/java/org/apache/commons/codec/binary/Base64.java
+++ b/src/java/org/apache/commons/codec/binary/Base64.java
@@ -560,9 +560,15 @@ public class Base64 implements BinaryEncoder, BinaryDecoder {
             }
             byte b = in[inPos++];
             if (b == PAD) {
-                // We're done.
-                eof = true;
-                break;
+                if (modulus == 0 || modulus == 1) {
+                    eof = true;
+                    break;
+                } else {
+                    // We're done.
+                    buffer[pos++] = (byte) ((x >> 4) & MASK_8BITS);
+                    eof = true;
+                    break;
+                }
             } else {
                 if (b >= 0 && b < DECODE_TABLE.length) {
                     int result = DECODE_TABLE[b];
@@ -587,12 +591,11 @@ public class Base64 implements BinaryEncoder, BinaryDecoder {
             x = x << 6;
             switch (modulus) {
                 case 2 :
-                    x = x << 6;
-                    buffer[pos++] = (byte) ((x >> 16) & MASK_8BITS);
+                    buffer[pos++] = (byte) ((x >> 4) & MASK_8BITS);
                     break;
                 case 3 :
-                    buffer[pos++] = (byte) ((x >> 16) & MASK_8BITS);
-                    buffer[pos++] = (byte) ((x >> 8) & MASK_8BITS);
+                    buffer[pos++] = (byte) ((x >> 10) & MASK_8BITS);
+                    buffer[pos++] = (byte) ((x >> 2) & MASK_8BITS);
                     break;
             }
         }
