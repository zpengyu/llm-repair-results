public void close() throws IOException {
    if (!closed) {
        flush();
        closed = true;
    }
}