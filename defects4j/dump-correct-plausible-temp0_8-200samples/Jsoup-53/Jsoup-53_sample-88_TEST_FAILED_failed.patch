diff --git a/src/main/java/org/jsoup/parser/TokenQueue.java b/src/main/java/org/jsoup/parser/TokenQueue.java
index b2f5b48..dc16747 100644
--- a/src/main/java/org/jsoup/parser/TokenQueue.java
+++ b/src/main/java/org/jsoup/parser/TokenQueue.java
@@ -262,9 +262,12 @@ public class TokenQueue {
         int end = -1;
         int depth = 0;
         char last = 0;
-
+        boolean reachedEnd = false;
         do {
-            if (isEmpty()) break;
+            if (isEmpty()) {
+                reachedEnd = true;
+                break;
+            }
             Character c = consume();
             if (last == 0 || last != ESC) {
                 if (c.equals(open)) {
