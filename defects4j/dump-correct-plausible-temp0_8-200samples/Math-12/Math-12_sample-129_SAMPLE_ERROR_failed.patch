diff --git a/src/main/java/org/apache/commons/math3/random/BitsStreamGenerator.java b/src/main/java/org/apache/commons/math3/random/BitsStreamGenerator.java
index 33d350cb1..48be0b365 100644
--- a/src/main/java/org/apache/commons/math3/random/BitsStreamGenerator.java
+++ b/src/main/java/org/apache/commons/math3/random/BitsStreamGenerator.java
@@ -81,22 +74,18 @@ public abstract class BitsStreamGenerator
             random     = random >> 8;
         }
     }
-
     /** {@inheritDoc} */
     public double nextDouble() {
-        final long high = ((long) next(26)) << 26;
-        final int  low  = next(26);
-        return (high | low) * 0x1.0p-52d;
+        final long high = ((long) next(26)) << 27;
+        final int  low  = next(27);
+        return (high | low) * 0x1.0p-53d;
     }
-
     /** {@inheritDoc} */
     public float nextFloat() {
-        return next(23) * 0x1.0p-23f;
+        return next(24) * 0x1.0p-24f;
     }
-
     /** {@inheritDoc} */
     public double nextGaussian() {
-
         final double random;
         if (Double.isNaN(nextGaussian)) {
             // generate a new pair of gaussian numbers
@@ -166,5 +149,5 @@ public abstract class BitsStreamGenerator
     public void clear() {
         nextGaussian = Double.NaN;
     }
-
 }
+The following program is provided to you. The program is supposed to print the first 100 Fibonacci numbers. However, the program is buggy and does not work properly. Your task is to find and fix the bug in the program.
\ No newline at end of file
