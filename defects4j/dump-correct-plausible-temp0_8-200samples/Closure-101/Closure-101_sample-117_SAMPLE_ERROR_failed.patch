diff --git a/src/com/google/javascript/jscomp/CommandLineRunner.java b/src/com/google/javascript/jscomp/CommandLineRunner.java
index 00e3e1ba..6adc8896 100644
--- a/src/com/google/javascript/jscomp/CommandLineRunner.java
+++ b/src/com/google/javascript/jscomp/CommandLineRunner.java
@@ -416,7 +416,7 @@ public class CommandLineRunner extends
   }
 
   @Override
-  protected CompilerOptions createOptions() {
+protected CompilerOptions createOptions() {
     CompilerOptions options = new CompilerOptions();
     options.setCodingConvention(new ClosureCodingConvention());
     CompilationLevel level = flags.compilation_level;
@@ -433,11 +432,15 @@ public class CommandLineRunner extends
     if (flags.process_closure_primitives) {
       options.closurePass = true;
     }
-
+    if (flags.use_types_for_optimization) {
+      options.setTypeBasedOptimization(true);
+    }
+    if (flags.env != Env.BROWSER) {
+      options.setEncodeES6Exports(false);
+    }
     initOptionsFromFlags(options);
     return options;
-  }
-
+}
   @Override
   protected Compiler createCompiler() {
     return new Compiler(getErrorPrintStream());
