diff --git a/src/main/java/org/apache/commons/math3/optimization/univariate/BrentOptimizer.java b/src/main/java/org/apache/commons/math3/optimization/univariate/BrentOptimizer.java
index 6905f1ac9..35d563c53 100644
--- a/src/main/java/org/apache/commons/math3/optimization/univariate/BrentOptimizer.java
+++ b/src/main/java/org/apache/commons/math3/optimization/univariate/BrentOptimizer.java
@@ -106,7 +106,7 @@ public class BrentOptimizer extends BaseAbstractUnivariateOptimizer {
 
     /** {@inheritDoc} */
     @Override
-    protected UnivariatePointValuePair doOptimize() {
+        protected UnivariatePointValuePair doOptimize() {
         final boolean isMinim = getGoalType() == GoalType.MINIMIZE;
         final double lo = getMin();
         final double mid = getStartValue();
@@ -251,14 +235,14 @@ public class BrentOptimizer extends BaseAbstractUnivariateOptimizer {
                         b = u;
                     }
                     if (fu <= fw ||
-                        Precision.equals(w, x)) {
+                        Precision.equals(w, x, 1.0e-15)) {
                         v = w;
                         fv = fw;
                         w = u;
                         fw = fu;
                     } else if (fu <= fv ||
-                               Precision.equals(v, x) ||
-                               Precision.equals(v, w)) {
+                               Precision.equals(v, x, 1.0e-15) ||
+                               Precision.equals(v, w, 1.0e-15)) {
                         v = u;
                         fv = fu;
                     }
